# Malware Test

Our malware scanner is designed to detect and identify potentially malicious or suspicious PHP code in web applications and files. It is primarily used for identifying PHP-based malware, backdoors, and other security threats that may have been injected into PHP files. The following status will be returned from this test:

- Success: No malicious or suspicious code detected.
- Falure: Something in the plugin under test has been flagged as potentially dangerous.

## Types of Issues Flagged
- `NonPrintableChars`: Obfuscated or malicious PHP code that includes non-printable characters.
PasswordProtection: It may indicate a weak or insecure password validation method.
- `ObfuscatedPhp`: Functions like eval, preg_replace, and various evasion techniques used by obfuscation tools.
- `DodgyPhp`: Suspicious PHP code patterns that may be used in malicious scripts, such as bypassing safe mode, shell execution, and other potentially dangerous functions.
- `DangerousPhp`: Potentially dangerous PHP functions and system calls that can be used for malicious purposes. It focuses on functions like exec, system, and shell_exec.
- `HiddenInAFile`: Identifies suspicious files that may hide malicious PHP code, such as GIF, PNG, or JPEG files that include obfuscated PHP code.
- `CloudFlareBypass`: Detects potential indicators of an attempt to bypass CloudFlare's security measures. It checks for specific parameters related to CloudFlare challenges.
- `SuspiciousEncoding`: Identifies various forms of encoding often used to obfuscate or hide malicious PHP code. It looks for base64 encoding, hexadecimal encoding, string reversal, and other encoding techniques.
- `DodgyStrings`: Detects suspicious strings often associated with malicious activities, such as filenames, system commands, and shell-related operations. It may indicate attempts to perform unauthorized actions.
- `Websites`: Identifies references to various websites and domains that are commonly associated with hacking, exploits, or security vulnerabilities. It may indicate potential malicious intent or resource use.

## What to do if it fails

If your malware test is failing, please review the following steps:
- Open the test report.
- Identify the causes of the failure and confirm whether or not the error is a false positive.
  - For false positives, you can rerun the test and pass the offending path as part of the `whitelist_paths` param
  - For true positives, the offending code should be immediately addressed.
- If you identify a false positive that you believe would benefit the community if excluded for all malwate tests, please email us at qit@woocommerce.com so we can review and make the necessary adjustments.